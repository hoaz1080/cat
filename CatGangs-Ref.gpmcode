{"Id":"61f2f631-cef1-4193-8a65-45ed1530f50a","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"Catgangs Ref by @elnino610","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":46,"Title":"Khai báo biến: Cột B excel","ElementXpath":"","RawInput":"$excel[B]","VariableNameForOutput":"url"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":46,"Title":"Khai báo biến: Sửa lại đường dẫn lưu file excel","ElementXpath":"","RawInput":"C:\\Users\\N.T.Duc\\Desktop\\GPM\\CatsGang_new.xlsx","VariableNameForOutput":"linkWb"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":2,"Title":"Truy cập thẳng link bot","ElementXpath":"","RawInput":"$url","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//a[@class=\"tgme_action_button_new tgme_action_web_button\"]","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":30,"Title":"Chạy mã Javascript","ElementXpath":"","RawInput":"document.querySelector('a.tgme_action_button_new.tgme_action_web_button').click();","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"","ElementXpath":"","RawInput":"1000,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"BL: Chat list","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":46,"Title":"Khai báo biến","ElementXpath":"","RawInput":"//ul[@class='chatlist']","VariableNameForOutput":"xpath"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"WE: Login checker","ElementXpath":"$xpath","RawInput":"15","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":3,"Name":"IfElse","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":4,"Name":"If","ActionOrBlocks":[],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":5,"Name":"Else","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":30,"Title":"Display error: Die","ElementXpath":"","RawInput":"const elscreen = document.createElement('div'); elscreen.style.cssText = 'position: fixed;inset: 0px;background: rgb(255 233 233 / 89%);z-index: 20000;display: flex;justify-content: center;align-items: center;font-size: 80pt;color: rgb(161 10 10);'; elscreen.innerHTML = 'DIE';  document.body.appendChild(elscreen);","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"2000,2500","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":30,"Title":"Tài khoản không khả dụng","ElementXpath":"","RawInput":"throw new Error('Tài khoản không khả dụng');","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}}],"BlockCondition":"hasElement($xpath)","ForBlockLoopCount":"","IsExpandUI":true}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"Launch","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":46,"Title":"xpath","ElementXpath":"","RawInput":"//*[text()='Launch']","VariableNameForOutput":"xpath"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"","ElementXpath":"$xpath","RawInput":"5","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":3,"Name":"Click","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":4,"Name":"If","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":12,"Title":"","ElementXpath":"$xpath","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":5,"Name":"Else","ActionOrBlocks":[],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}}],"BlockCondition":"hasElement($xpath)","ForBlockLoopCount":"","IsExpandUI":true}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ load app","ElementXpath":"//iframe[@class=\"payment-verification\"]","RawInput":"120","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":10,"Title":"Đọc Attribute element","ElementXpath":"//iframe[@src]","RawInput":"src","VariableNameForOutput":"link"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"Vào ref","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":21,"Title":"Switch qua frame","ElementXpath":"//iframe[@class=\"payment-verification\"]","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"BL: Wow let's go","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":46,"Title":"Khai báo biến","ElementXpath":"","RawInput":"//*[text()=\"Wow, let’s go!\"]/parent::button","VariableNameForOutput":"xpath"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"$xpath","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":3,"Name":"IfElse","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":4,"Name":"If","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":12,"Title":"Click chuột","ElementXpath":"$xpath","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"500,700","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":5,"Name":"Else","ActionOrBlocks":[],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}}],"BlockCondition":"hasElement($xpath)","ForBlockLoopCount":"","IsExpandUI":true}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//p[text()=\"Tasks\"]","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"1000,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":22,"Title":"Switch về mặc định","ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"BL: Get Link Ref","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"1500,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":36,"Title":"Tạo excel workbook","ElementXpath":"","RawInput":"$linkWb","VariableNameForOutput":"wb"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":33,"Title":"Ghi excel","ElementXpath":null,"RawInput":"$wb;A;$profile_name","VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":33,"Title":"Ghi excel","ElementXpath":null,"RawInput":"$wb;B;$link","VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}},{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"1000,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"END","ActionOrBlocks":[],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}},{"Type":0,"Action":{"ActionType":30,"Title":"Aleart Thành công!","ElementXpath":"","RawInput":"const elscreen = document.createElement('div'); elscreen.style.cssText = 'position: fixed;inset: 0px;background: rgb(206 236 206 / 89%);z-index: 20000;display: flex;justify-content: center;align-items: center;font-size: 80pt;color: #005a1c;'; elscreen.innerHTML = 'OK'; document.body.appendChild(elscreen);","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"Tiến trình hoàn tất","ElementXpath":"","RawInput":"1000,1500","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":2,"Name":"While","ActionOrBlocks":[],"BlockCondition":"END_DATA","ForBlockLoopCount":null,"IsExpandUI":true}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}}],"VariableData":[{"Name":"excel","Action":null},{"Name":"profile_id","Action":null},{"Name":"profile_name","Action":null},{"Name":"loopIndex","Action":null},{"Name":"url","Action":{"ActionType":46,"Title":"Khai báo biến: Cột B excel","ElementXpath":"","RawInput":"$excel[B]","VariableNameForOutput":"url"}},{"Name":"linkWb","Action":{"ActionType":46,"Title":"Khai báo biến: Sửa lại đường dẫn lưu file excel","ElementXpath":"","RawInput":"C:\\Users\\N.T.Duc\\Desktop\\GPM\\CatsGang_new.xlsx","VariableNameForOutput":"linkWb"}},{"Name":"xpath","Action":{"ActionType":46,"Title":"Khai báo biến","ElementXpath":"","RawInput":"//ul[@class='chatlist']","VariableNameForOutput":"xpath"}},{"Name":"link","Action":{"ActionType":10,"Title":"Đọc Attribute element","ElementXpath":"//iframe[@src]","RawInput":"src","VariableNameForOutput":"link"}},{"Name":"linkRef","Action":{"ActionType":30,"Title":"Chạy mã Javascript","ElementXpath":"","RawInput":"const main = async () => {    try {        let e = document.querySelector(\"iframe\");        if (!e) throw Error(\"No iframe found\");        let t = new URL(e.src),            n = t.hash,            a = new URLSearchParams(n.slice(1)),            i = a.get(\"tgWebAppData\");        let auth = \"tma \" + i;        console.log(\"[@elnino610] Logging in...\");        let o = await fetch(\"https://cats-backend-wkejfn-production.up.railway.app/user\", {                method: \"GET\",                headers: {                    \"Content-Type\": \"application/json;charset=utf-8\",                    \"Authorization\": auth                }            }).then(e => e.json()),            r = o.referrerCode;        let refLink = \"t.me/catsgang_bot/join?startapp=\" + r;        return refLink;    } catch (h) {        return \"\"    }};return await main();","VariableNameForOutput":"linkRef"}},{"Name":"wb","Action":{"ActionType":36,"Title":"Tạo excel workbook","ElementXpath":"","RawInput":"$linkWb","VariableNameForOutput":"wb"}}]}